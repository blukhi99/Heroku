(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{406:function(e,t,r){"use strict";r.r(t);r(4),r(3),r(1),r(5),r(2),r(6);var n=r(27),o=r(9),l=r(0),d=(r(31),r(91),r(76),r(25)),m=r(60);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={computed:f(f({},Object(d.d)([])),{},{disableModalItem:function(){return"View"===this.writeMode},modalItemPriority:{get:function(){return 10*this.modalItem.priorityMin+this.modalItem.priorityMax},set:function(e){var t=this.priorities.find((function(t){return t.value===e}));t&&(this.modalItem.priorityMin=t.min,this.modalItem.priorityMax=t.max)}},modalItemUserId:{get:function(){return this.modalItem.userId?this.modalItem.userId._id:this.modalItem.userId},set:function(e){this.modalItem.userId=e}},modalItemAlarmDef:{get:function(){return this.modalItem.alarmDef?this.modalItem.alarmDef._id:this.modalItem.alarmDef},set:function(e){this.modalItem.alarmDef=e}}}),mixins:[m.a],watch:{"modalItem.alarmDef._id":{handler:function(){var e=this;if(0!==this.modalItem.alarmDef._id){var t=this.alarms.find((function(t){return t._id===e.modalItem.alarmDef._id}));t&&(this.modalItem.class=t.class,this.modalItem.priorityMin=t.priority,this.modalItem.priorityMax=t.priority)}else this.modalItem.class=""}},"modalItem.userId._id":{handler:function(){this.updateNotificationUser()}},"modalItem.type":{handler:function(){this.updateNotificationUser()}}},data:function(){return{notifications:[],users:[],alarms:[],modalItem:{type:"email",priorityMin:1,priorityMax:5,when:"anytime",userId:{_id:0},alarmDef:{_id:0}},addingItem:{type:"email",priorityMin:1,priorityMax:5,when:"anytime",userId:{_id:0},alarmDef:{_id:0}},isLoading:!1,writeMode:"",types:[{name:"Email",value:"email"},{name:"Sms",value:"sms"},{name:"Voice",value:"voice"}],notifyTime:[{name:"Anytime",value:"anytime"},{name:"8am-11pm",value:"wake"},{name:"8am-5pm",value:"daytime"},{name:"8am-11pm, Weekdays only",value:"wake-weekdays"},{name:"8am-5pm, Weekdays only",value:"daytime-weekdays"},{name:"Daily Email Report",value:"daily"},{name:"Weekly Email Report",value:"weekly"}],priorities:[{name:"1 only",value:11,min:1,max:1},{name:"1 - 2",value:12,min:1,max:2},{name:"1 - 3",value:13,min:1,max:3},{name:"1 - 4",value:14,min:1,max:4},{name:"1 - 5",value:15,min:1,max:5},{name:"2 only",value:22,min:2,max:2},{name:"2 - 3",value:23,min:2,max:3},{name:"2 - 4",value:24,min:2,max:4},{name:"2 - 5",value:25,min:2,max:5},{name:"3 only",value:33,min:3,max:3},{name:"3 - 4",value:34,min:3,max:4},{name:"3 - 5",value:35,min:3,max:5},{name:"4 only",value:44,min:4,max:4},{name:"4 - 5",value:45,min:4,max:5},{name:"5 only",value:55,min:5,max:5}]}},mounted:function(){this.getNotificationsDefs(),this.getUsers(),this.getAlarmsDefs()},methods:f(f({},Object(d.c)([])),{},{getUsers:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,data,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$getUsers();case 2:r=t.sent,o=r.status,data=r.data,200===o?(e.users=[{name:"External User",_id:0}],(l=e.users).push.apply(l,Object(n.a)(data))):console.error("Response","Error");case 6:case"end":return t.stop()}}),t)})))()},getAlarmsDefs:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,data,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$getAlarmsDefs();case 2:r=t.sent,o=r.status,data=r.data,200===o?(e.alarms=[{name:"All Alarms that match Class & Priority",_id:0}],(l=e.alarms).push.apply(l,Object(n.a)(data))):console.error("Response","Error");case 6:case"end":return t.stop()}}),t)})))()},getNotificationsDefs:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$getNotificationsDefs();case 2:r=t.sent,n=r.status,data=r.data,200===n?e.notifications=data:console.error("Response","Error");case 6:case"end":return t.stop()}}),t)})))()},deleteItem:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,l,d,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$confirmDelete(t);case 2:if(!r.sent){r.next=19;break}return r.prev=4,r.next=7,t.$deleteNotificationDef(e);case 7:n=r.sent,o=n.status,n.data,200===o&&(t.$delete(t.notifications,t.notifications.findIndex((function(t){return t._id===e._id}))),t.$toAst(t,"Deleted Successfully","success")),r.next=19;break;case 13:r.prev=13,r.t0=r.catch(4),l=r.t0.message,d=r.t0.response,m=d?d.data:l,t.$toAst(t,m,"danger");case 19:case"end":return r.stop()}}),r,null,[[4,13]])})))()},showModal:function(){this.$refs["modal-crud-notifications"].show()},hideModal:function(){this.$refs["modal-crud-notifications"].hide()},addNewItem:function(){this.writeMode="Add",this.modalItem=this.addingItem,this.showModal()},editItem:function(e){this.writeMode="Edit",this.modalItem=e,this.showModal()},viewItem:function(e){this.writeMode="View",this.modalItem=e,this.showModal()},updateNotificationUser:function(){var e=this;if(0!==this.modalItem.userId._id){var t=this.users.find((function(t){return t._id===e.modalItem.userId._id}));if(t)switch(this.modalItem.type){case"email":this.modalItem.address=t.email;break;case"sms":case"voice":this.modalItem.address=t.phone}}else this.modalItem.address=""},writeItem:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,data,l,d,m,c,f,v,h,I;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.preventDefault(),t.isLoading=!0,"Add"!==t.writeMode){r.next=18;break}return r.prev=3,r.next=6,t.$addNotificationDef(t.modalItem);case 6:n=r.sent,o=n.status,data=n.data,200===o?(t.notifications.push(data),t.addingItem={type:"email",priorityMin:1,priorityMax:5,when:"anytime",userId:{_id:0},alarmDef:{_id:0}},t.hideModal()):console.error("Error Add Notification"),r.next=18;break;case 12:r.prev=12,r.t0=r.catch(3),l=r.t0.message,d=r.t0.response,m=d?d.data:l,t.$toAst(t,m,"danger");case 18:if("Edit"!==t.writeMode){r.next=34;break}return r.prev=19,r.next=22,t.$editNotificationDef(t.modalItem);case 22:c=r.sent,f=c.status,c.data,200===f?(t.$set(t.notifications,t.notifications.findIndex((function(e){return e._id===t.modalItem._id})),t.$deepClone(t.modalItem)),t.hideModal()):console.error("Error Edit Notification"),r.next=34;break;case 28:r.prev=28,r.t1=r.catch(19),v=r.t1.message,h=r.t1.response,I=h?h.data:v,t.$toAst(t,I,"danger");case 34:t.isLoading=!1;case 35:case"end":return r.stop()}}),r,null,[[3,12],[19,28]])})))()}})},h=r(14),component=Object(h.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-card",{staticClass:"mx-2 full-screen",attrs:{"no-body":""}},[r("b-row",{staticClass:"mx-0 bg-default"},[r("b-col",{staticClass:"text-left"},[r("h1",{staticClass:"h2"},[r("span",{staticClass:"specialty"},[e._v("Notifications")])])]),e._v(" "),r("b-col",{staticClass:"text-right"},[r("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:e.addNewItem}},[e._v("Add")])],1)],1),e._v(" "),r("b-table-simple",{staticClass:"h-100 mb-0 d-inline-block sticky-table",attrs:{bordered:"",hover:"",small:"",responsive:"","sticky-header":""}},[r("b-thead",[r("b-tr",[r("b-th",{staticClass:"text-nowrap"},[e._v("#")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Who")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Type")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Where")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("When")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Alarm ID")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Class")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Priority")]),e._v(" "),r("b-th",{staticClass:"text-nowrap"},[e._v("Action")])],1)],1),e._v(" "),e._l(e.notifications,(function(t,n){return r("b-tbody",{key:n},[r("b-tr",[r("b-td",{staticClass:"text-center"},[e._v(e._s(n+1))]),e._v(" "),r("b-td",[e._v(e._s((t.userId||{}).name))]),e._v(" "),r("b-td",[e._v(e._s(t.type))]),e._v(" "),r("b-td",[e._v(e._s(t.address))]),e._v(" "),r("b-td",[e._v(e._s(t.when))]),e._v(" "),r("b-td",[e._v(e._s((t.alarmDef||{}).name))]),e._v(" "),r("b-td",[e._v(e._s(t.class))]),e._v(" "),r("b-td",[e._v(e._s(t.priorityMin)+"-"+e._s(t.priorityMax))]),e._v(" "),r("b-td",{staticClass:"text-center"},[r("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-primary"},on:{click:function(r){return e.viewItem(t)}}},[r("font-awesome-icon",{attrs:{icon:["fas","eye"]}})],1),e._v(" "),r("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-info"},on:{click:function(r){return e.editItem(t)}}},[r("font-awesome-icon",{attrs:{icon:["fas","pencil-alt"]}})],1),e._v(" "),r("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-danger"},on:{click:function(r){return e.deleteItem(t)}}},[r("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}})],1)],1)],1)],1)}))],2)],1),e._v(" "),r("b-modal",{ref:"modal-crud-notifications",attrs:{id:"modal-crud-notifications",size:"lg",title:e.writeMode,"hide-footer":""}},[r("b-row",[r("b-col",[r("b-overlay",{attrs:{show:e.isLoading,rounded:"sm"}},[e.modalItem?r("b-form",{on:{submit:e.writeItem}},[r("b-form-group",{attrs:{id:"input-type-group",label:"Type:","label-for":"input-type"}},[r("b-form-select",{attrs:{id:"input-type",options:e.types,"value-field":"value","text-field":"name",placeholder:"Enter Type",disabled:e.disableModalItem},model:{value:e.modalItem.type,callback:function(t){e.$set(e.modalItem,"type",t)},expression:"modalItem.type"}})],1),e._v(" "),r("b-form-group",{attrs:{id:"input-send-to-group",label:"Send To:","label-for":"input-send-to"}},[r("b-form-select",{attrs:{id:"input-send-to",options:e.users,"value-field":"_id","text-field":"name","disabled-field":"notEnabled",placeholder:"Enter Send To",disabled:e.disableModalItem},model:{value:e.modalItem.userId._id,callback:function(t){e.$set(e.modalItem.userId,"_id",t)},expression:"modalItem.userId._id"}})],1),e._v(" "),"email"===e.modalItem.type?r("b-form-group",{attrs:{id:"input-name-address-group",label:"Address:","label-for":"input-name-address"}},[r("b-form-input",{attrs:{id:"input-name-address",type:"email",placeholder:"Enter Email",required:"",disabled:e.disableModalItem||0!==e.modalItem.userId._id},model:{value:e.modalItem.address,callback:function(t){e.$set(e.modalItem,"address",t)},expression:"modalItem.address"}})],1):r("b-form-group",{attrs:{id:"input-name-address-group",label:"Address:","label-for":"input-name-address"}},[r("b-form-input",{attrs:{id:"input-name-address",type:"tel",placeholder:"Enter Phone",required:"",disabled:e.disableModalItem||0!==e.modalItem.userId._id},model:{value:e.modalItem.address,callback:function(t){e.$set(e.modalItem,"address",t)},expression:"modalItem.address"}})],1),e._v(" "),r("b-form-group",{attrs:{id:"input-when-to-notify-group",label:"When to notify:","label-for":"input-when-to-notify"}},[r("b-form-select",{attrs:{id:"input-when-to-notify",options:e.notifyTime,"value-field":"value","text-field":"name",placeholder:"When to notify",disabled:e.disableModalItem},model:{value:e.modalItem.when,callback:function(t){e.$set(e.modalItem,"when",t)},expression:"modalItem.when"}})],1),e._v(" "),r("b-form-group",{attrs:{id:"input-add-if-not-ack-for-group",label:"Notify if the Alarm is not Acknowledge:","label-for":"input-add-if-not-ack-for"}},[r("b-form-input",{attrs:{id:"input-add-if-not-ack-for",type:"number",min:"0",step:"1",placeholder:"Enter Minutes",disabled:e.disableModalItem},model:{value:e.modalItem.ifNotAckFor,callback:function(t){e.$set(e.modalItem,"ifNotAckFor",t)},expression:"modalItem.ifNotAckFor"}})],1),e._v(" "),r("b-form-group",{attrs:{id:"input-alarm-selection-group",label:"Alarm Selection:","label-for":"input-alarm-selection"}},[r("b-form-select",{attrs:{id:"input-alarm-selection",options:e.alarms,"value-field":"_id","text-field":"name",placeholder:"Alarm Selection",disabled:e.disableModalItem},model:{value:e.modalItem.alarmDef._id,callback:function(t){e.$set(e.modalItem.alarmDef,"_id",t)},expression:"modalItem.alarmDef._id"}})],1),e._v(" "),r("b-form-group",{attrs:{id:"input-class-group",label:"Class:","label-for":"input-class"}},[r("b-form-input",{attrs:{id:"input-class",type:"text",placeholder:"Enter comma Seperated class names",disabled:e.disableModalItem||0!==e.modalItem.alarmDef._id},model:{value:e.modalItem.class,callback:function(t){e.$set(e.modalItem,"class",t)},expression:"modalItem.class"}})],1),e._v(" "),r("b-form-group",{attrs:{id:"input-priority-group",label:"Priority:","label-for":"input-priority"}},[r("b-form-select",{attrs:{id:"input-priority",options:e.priorities,"value-field":"value","text-field":"name",placeholder:"Priority",disabled:e.disableModalItem||0!==e.modalItem.alarmDef._id},model:{value:e.modalItemPriority,callback:function(t){e.modalItemPriority=t},expression:"modalItemPriority"}})],1),e._v(" "),r("b-row",[r("b-col",{staticClass:"text-right"},[r("b-button",{attrs:{type:"button",size:"sm",variant:"danger"},on:{click:e.hideModal}},[e._v("Cancel")]),e._v(" "),e.disableModalItem?e._e():r("b-button",{attrs:{type:"submit",size:"sm",variant:"primary"}},[e._v("Save")])],1)],1)],1):e._e()],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);