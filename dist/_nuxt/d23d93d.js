(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{369:function(e,t,o){var content=o(387);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(35).default)("2461e21f",content,!0,{sourceMap:!1})},386:function(e,t,o){"use strict";o(369)},387:function(e,t,o){var r=o(34)(!1);r.push([e.i,".condition[data-v-0bffc218]{width:50px;display:inline-flex}",""]),e.exports=r},402:function(e,t,o){"use strict";o.r(t);o(4),o(3),o(1),o(5),o(6);var r=o(9),n=o(0),l=(o(31),o(13),o(112),o(2),o(76),o(91),o(25)),d=o(60);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={computed:c(c({},Object(l.d)([])),{},{disableModalItem:function(){return"View"===this.writeMode}}),mixins:[d.a],data:function(){return{priorities:Array(5).fill().map((function(e,t){return t})),modes:["Always","Cooling","Heating","Running","Stopped"],endPointsData:[],alarms:[],modalItem:{priority:1,mode:"Always",alarmType:"endpoint",compare:">",enabled:!0},addingItem:{priority:1,mode:"Always",alarmType:"endpoint",compare:">",enabled:!0},isLoading:!1,writeMode:""}},mounted:function(){this.getAlarmsDefs(),this.getEndPointsDef()},methods:c(c({},Object(l.c)([])),{},{getAlarmsDefs:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o,r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$getAlarmsDefs();case 2:o=t.sent,r=o.status,data=o.data,200===r?e.alarms=data:console.error("Response","Error");case 6:case"end":return t.stop()}}),t)})))()},getEndPointsDef:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o,r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$getEndPointsDef(e.currentSite);case 2:o=t.sent,r=o.status,data=o.data,200===r?(e.endPointsData=data,e.endPointsData.forEach((function(e){e.enum||(e.enum=[]),e.range||(e.range={}),e.address||(e.address={})}))):console.error("Response","Error");case 6:case"end":return t.stop()}}),t)})))()},deleteItem:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,n,l,d,m;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.$confirmDelete(t);case 2:if(!o.sent){o.next=19;break}return o.prev=4,o.next=7,t.$deleteAlarm(e);case 7:r=o.sent,n=r.status,r.data,200===n&&(t.$delete(t.alarms,t.alarms.findIndex((function(t){return t._id===e._id}))),t.$toAst(t,"Deleted Successfully","success")),o.next=19;break;case 13:o.prev=13,o.t0=o.catch(4),l=o.t0.message,d=o.t0.response,m=d?d.data:l,t.$toAst(t,m,"danger");case 19:case"end":return o.stop()}}),o,null,[[4,13]])})))()},onSelect:function(){this.$refs.endpointGroup.onSelect(),this.$refs["modal-end-point-group"].hide()},onCancelGroupModal:function(){this.$refs["modal-end-point-group"].hide()},getEndPointName:function(e){return(this.endPointsData.find((function(t){return t._id===e}))||{}).displayName},showModal:function(){this.$refs["modal-crud-alarms"].show()},hideModal:function(){this.$refs["modal-crud-alarms"].hide()},addNewItem:function(){this.writeMode="Add",this.modalItem=this.addingItem,this.showModal()},editItem:function(e){this.writeMode="Edit",this.modalItem=this.$deepClone(e),this.showModal()},viewItem:function(e){this.writeMode="View",this.modalItem=e,this.showModal()},writeItem:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,n,data,l,d,m,c,f,v,h,y;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.preventDefault(),t.isLoading=!0,"Add"!==t.writeMode){o.next=18;break}return o.prev=3,o.next=6,t.$addAlarmsDef(t.modalItem);case 6:r=o.sent,n=r.status,data=r.data,200===n?(t.alarms.push(data),t.addingItem={priority:1,mode:"Always",alarmType:"endpoint",compare:">",enabled:!0},t.hideModal()):console.error("Error Add Alarm"),o.next=18;break;case 12:o.prev=12,o.t0=o.catch(3),l=o.t0.message,d=o.t0.response,m=d?d.data:l,t.$toAst(t,m,"danger");case 18:if("Edit"!==t.writeMode){o.next=34;break}return o.prev=19,o.next=22,t.$editAlarmsDef(t.modalItem);case 22:c=o.sent,f=c.status,c.data,200===f?(t.$set(t.alarms,t.alarms.findIndex((function(e){return e._id===t.modalItem._id})),t.$deepClone(t.modalItem)),t.hideModal()):console.error("Error Edit Alarm"),o.next=34;break;case 28:o.prev=28,o.t1=o.catch(19),v=o.t1.message,h=o.t1.response,y=h?h.data:v,t.$toAst(t,y,"danger");case 34:t.isLoading=!1;case 35:case"end":return o.stop()}}),o,null,[[3,12],[19,28]])})))()}})},v=(o(386),o(14)),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-card",{staticClass:"mx-2 full-screen",attrs:{"no-body":""}},[o("b-row",{staticClass:"mx-0 bg-default"},[o("b-col",{staticClass:"text-left"},[o("h1",{staticClass:"h2"},[o("span",{staticClass:"specialty"},[e._v("Alarms")])])]),e._v(" "),o("b-col",{staticClass:"text-right"},[o("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:e.addNewItem}},[e._v("Add")])],1)],1),e._v(" "),o("b-table-simple",{staticClass:"h-100 mb-0 d-inline-block sticky-table",attrs:{bordered:"",hover:"",small:"",responsive:"","sticky-header":""}},[o("b-thead",[o("b-tr",[o("b-th",{staticClass:"text-nowrap"},[e._v("#")]),e._v(" "),o("b-th",{staticClass:"text-nowrap"},[e._v("Name")]),e._v(" "),o("b-th",{staticClass:"text-nowrap"},[e._v("Class")]),e._v(" "),o("b-th",{staticClass:"text-nowrap"},[e._v("Priority")]),e._v(" "),o("b-th",{staticClass:"text-nowrap"},[e._v("Action")])],1)],1),e._v(" "),e._l(e.alarms,(function(t,r){return o("b-tbody",{key:r},[o("b-tr",[o("b-td",{staticClass:"text-center"},[e._v(e._s(r+1))]),e._v(" "),o("b-td",[e._v(e._s(t.name))]),e._v(" "),o("b-td",[e._v(e._s(t.class))]),e._v(" "),o("b-td",[e._v(e._s(t.priority))]),e._v(" "),o("b-td",{staticClass:"text-center"},[o("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-primary"},on:{click:function(o){return e.viewItem(t)}}},[o("font-awesome-icon",{attrs:{icon:["fas","eye"]}})],1),e._v(" "),o("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-info"},on:{click:function(o){return e.editItem(t)}}},[o("font-awesome-icon",{attrs:{icon:["fas","pencil-alt"]}})],1),e._v(" "),o("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-danger"},on:{click:function(o){return e.deleteItem(t)}}},[o("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}})],1)],1)],1)],1)}))],2)],1),e._v(" "),o("b-modal",{ref:"modal-crud-alarms",attrs:{id:"modal-crud-alarms",size:"lg",title:e.writeMode,"hide-footer":""}},[o("b-row",[o("b-col",[o("b-overlay",{attrs:{show:e.isLoading,rounded:"sm"}},[o("b-form",{on:{submit:e.writeItem}},[o("b-form-group",{attrs:{id:"input-name-group",label:"Name: *","label-for":"input-name"}},[o("b-form-input",{attrs:{id:"input-name",type:"text",placeholder:"Short Name of alarm",required:"",disabled:e.disableModalItem},model:{value:e.modalItem.name,callback:function(t){e.$set(e.modalItem,"name",t)},expression:"modalItem.name"}})],1),e._v(" "),o("b-row",[o("b-col",{attrs:{sm:"12",md:"8"}},[o("b-form-group",{attrs:{id:"input-class-group",label:"Class:","label-for":"input-class"}},[o("b-form-input",{attrs:{id:"input-class",type:"text",placeholder:"Enter comma separated class names",disabled:e.disableModalItem},model:{value:e.modalItem.class,callback:function(t){e.$set(e.modalItem,"class",t)},expression:"modalItem.class"}})],1)],1),e._v(" "),o("b-col",{attrs:{cols:"6",md:"2"}},[o("b-form-group",{attrs:{id:"input-priority-group",label:"Priority:","label-for":"input-priority"}},[o("b-form-select",{attrs:{id:"input-priority",type:"text",placeholder:"Enter Priority",options:e.priorities,disabled:e.disableModalItem},model:{value:e.modalItem.priority,callback:function(t){e.$set(e.modalItem,"priority",t)},expression:"modalItem.priority"}})],1)],1),e._v(" "),o("b-col",{attrs:{cols:"6",md:"2"}},[o("b-form-group",{attrs:{id:"input-mode-group",label:"Mode:","label-for":"input-mode"}},[o("b-form-select",{attrs:{id:"input-mode",type:"text",placeholder:"Enter Mode",options:e.modes,disabled:e.disableModalItem},model:{value:e.modalItem.mode,callback:function(t){e.$set(e.modalItem,"mode",t)},expression:"modalItem.mode"}})],1)],1)],1),e._v(" "),o("b-form-group",{attrs:{label:"Alarm Type"}},[o("b-form-radio-group",{attrs:{name:"radio-alarm-type",disabled:e.disableModalItem},model:{value:e.modalItem.alarmType,callback:function(t){e.$set(e.modalItem,"alarmType",t)},expression:"modalItem.alarmType"}},[o("b-form-radio",{attrs:{value:"endpoint"}},[e._v("Threshold Alarm")]),e._v(" "),o("b-form-radio",{attrs:{value:"code"}},[e._v("Program Alarm")])],1)],1),e._v(" "),"code"===e.modalItem.alarmType?o("b-form-group",{attrs:{id:"input-alarm-program-group",label:"Alarm Program:","label-for":"input-alarm-program"}},[o("b-form-textarea",{attrs:{id:"input-alarm-program",placeholder:"Enter Alarm Program",disabled:e.disableModalItem},model:{value:e.modalItem.code,callback:function(t){e.$set(e.modalItem,"code",t)},expression:"modalItem.code"}})],1):e._e(),e._v(" "),"endpoint"===e.modalItem.alarmType?o("div",{staticClass:"my-2"},[o("div",[o("span",{staticClass:"h5 mr-2"},[e._v(e._s(e.getEndPointName(e.modalItem.endpoint)))]),e._v(" "),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-end-point-group",modifiers:{"modal-end-point-group":!0}}],attrs:{variant:"primary",size:"sm",disabled:e.disableModalItem}},[e._v("Choose An Endpoint")])],1),e._v(" "),o("b-row",{staticClass:"my-2"},[o("b-col",[o("span",[e._v("Alarm Condition  ")]),e._v(" "),o("b-form-select",{staticClass:"auto-width condition",attrs:{size:"sm",disabled:e.disableModalItem},model:{value:e.modalItem.compare,callback:function(t){e.$set(e.modalItem,"compare",t)},expression:"modalItem.compare"}},[o("b-form-select-option",{attrs:{value:">"}},[e._v(">")]),e._v(" "),o("b-form-select-option",{attrs:{value:"<"}},[e._v("<")])],1),e._v(" "),o("b-form-input",{staticClass:"auto-width",attrs:{type:"number",step:"0.1",min:"0",size:"sm",placeholder:"Enter Alarm Threshold",disabled:e.disableModalItem},model:{value:e.modalItem.alarmThreshold,callback:function(t){e.$set(e.modalItem,"alarmThreshold",e._n(t))},expression:"modalItem.alarmThreshold"}})],1)],1),e._v(" "),o("b-row",{staticClass:"my-2"},[o("b-col",[o("span",[e._v("Normal Condition")]),e._v(" "),o("span",{staticClass:"condition",staticStyle:{padding:"3px"}},[e._v(" "+e._s(">"===e.modalItem.compare?"<=":">=")+" ")]),e._v(" "),o("b-form-input",{staticClass:"auto-width",attrs:{type:"number",step:"0.1",min:"0",size:"sm",placeholder:"Enter Normal Threshold",disabled:e.disableModalItem},model:{value:e.modalItem.normalThreshold,callback:function(t){e.$set(e.modalItem,"normalThreshold",e._n(t))},expression:"modalItem.normalThreshold"}})],1)],1)],1):e._e(),e._v(" "),o("b-row",[o("b-col",{attrs:{cols:"12",md:"4"}},[o("b-form-group",{attrs:{id:"input-on-delay-group",label:"On Delay:","label-for":"input-on-delay"}},[o("b-form-input",{attrs:{id:"input-on-delay",type:"number",step:"0.1",min:"0",placeholder:"Enter # of minutes",disabled:e.disableModalItem},model:{value:e.modalItem.onDelay,callback:function(t){e.$set(e.modalItem,"onDelay",e._n(t))},expression:"modalItem.onDelay"}})],1)],1),e._v(" "),o("b-col",{attrs:{cols:"12",md:"4"}},[o("b-form-group",{attrs:{id:"input-off-delay-group",label:"Off Delay:","label-for":"input-off-delay"}},[o("b-form-input",{attrs:{id:"input-off-delay",type:"number",step:"0.1",min:"0",placeholder:"Enter # of minutes",disabled:e.disableModalItem},model:{value:e.modalItem.offDelay,callback:function(t){e.$set(e.modalItem,"offDelay",e._n(t))},expression:"modalItem.offDelay"}})],1)],1),e._v(" "),o("b-col",{attrs:{cols:"12",md:"4"}},[o("b-form-group",{attrs:{id:"input-rearm-delay-group",label:"Rearm Delay:","label-for":"input-rearm-delay"}},[o("b-form-input",{attrs:{id:"input-rearm-delay",type:"number",step:"0.1",min:"0",placeholder:"Enter # of minutes",disabled:e.disableModalItem},model:{value:e.modalItem.rearmDelay,callback:function(t){e.$set(e.modalItem,"rearmDelay",e._n(t))},expression:"modalItem.rearmDelay"}})],1)],1)],1),e._v(" "),o("b-form-group",{attrs:{id:"input-message-format-group",label:"Message Format: *","label-for":"input-message-format"}},[o("b-form-textarea",{attrs:{id:"input-message-format",placeholder:'Notification message. Use "[value-name]" place holders for current values',disabled:e.disableModalItem,required:""},model:{value:e.modalItem.messageFormat,callback:function(t){e.$set(e.modalItem,"messageFormat",t)},expression:"modalItem.messageFormat"}})],1),e._v(" "),o("b-row",[o("b-col",{staticClass:"text-right"},[o("b-form-checkbox",{staticClass:"d-inline-block",attrs:{id:"input-enabled-instance",disabled:e.disableModalItem},model:{value:e.modalItem.enabled,callback:function(t){e.$set(e.modalItem,"enabled",t)},expression:"modalItem.enabled"}},[e._v("  \n                    Enabled\n                  ")]),e._v(" "),o("b-button",{attrs:{type:"button",size:"sm",variant:"danger"},on:{click:e.hideModal}},[e._v("Cancel")]),e._v(" "),e.disableModalItem?e._e():o("b-button",{attrs:{type:"submit",size:"sm",variant:"primary"}},[e._v("Save")])],1)],1)],1)],1)],1)],1)],1),e._v(" "),o("b-modal",{ref:"modal-end-point-group",attrs:{size:"sm",id:"modal-end-point-group",title:"Select Endpoint","hide-footer":""}},[o("endpointGroup",{ref:"endpointGroup",attrs:{endPointsData:e.endPointsData},model:{value:e.modalItem.endpoint,callback:function(t){e.$set(e.modalItem,"endpoint",t)},expression:"modalItem.endpoint"}}),e._v(" "),o("div",{staticClass:"mt-2 text-right"},[o("b-button",{attrs:{type:"button",size:"sm",variant:"danger"},on:{click:e.onCancelGroupModal}},[e._v("Cancel")]),e._v(" "),o("b-button",{attrs:{type:"button",size:"sm",variant:"primary"},on:{click:e.onSelect}},[e._v("Select")])],1)],1)],1)}),[],!1,null,"0bffc218",null);t.default=component.exports}}]);