(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{408:function(t,e,r){"use strict";r.r(e);r(4),r(3),r(1),r(5),r(2),r(6);var n=r(27),o=r(9),d=r(0),l=(r(76),r(16),r(91),r(31),r(25)),c=r(60);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(d.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={computed:f(f({},Object(l.d)([])),{},{disableModalItem:function(){return"View"===this.writeMode},modalItemPropertyId:{get:function(){return this.modalItem.property?this.modalItem.property._id:null},set:function(t){this.modalItem.property._id=t}}}),mixins:[c.a],data:function(){return{properties:[],sites:[],modalItem:{property:{_id:null}},addingItem:{property:{_id:null}},isLoading:!1,writeMode:""}},mounted:function(){this.getSites(),this.getProperties()},methods:f(f({},Object(l.c)([])),{},{getProperties:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r,o,data,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$getProperties();case 2:r=e.sent,o=r.status,data=r.data,200===o?(t.properties=[{_id:null,name:"Please select an property"}],(d=t.properties).push.apply(d,Object(n.a)(data))):console.error("Response","Error");case 6:case"end":return e.stop()}}),e)})))()},getSites:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r,n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$getSites();case 2:r=e.sent,n=r.status,data=r.data,200===n?t.sites=data:console.error("Response","Error");case 6:case"end":return e.stop()}}),e)})))()},deleteItem:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,d,l,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$confirmDelete(e);case 2:if(!r.sent){r.next=19;break}return r.prev=4,r.next=7,e.$deleteSite(t);case 7:n=r.sent,o=n.status,n.data,200===o&&(e.$delete(e.sites,e.sites.findIndex((function(e){return e._id===t._id}))),e.$toAst(e,"Deleted Successfully","success")),r.next=19;break;case 13:r.prev=13,r.t0=r.catch(4),d=r.t0.message,l=r.t0.response,c=l?l.data:d,e.$toAst(e,c,"danger");case 19:case"end":return r.stop()}}),r,null,[[4,13]])})))()},getPropertyName:function(t){var e=t.property?t.property.name:null;if(!e){var r=this.properties.find((function(e){var r=e._id;return r===t.property._id||r===t.property}));r&&(e=r.name)}return e||""},showModal:function(){this.$refs["modal-crud-sites"].show()},hideModal:function(){this.$refs["modal-crud-sites"].hide()},addNewItem:function(){this.writeMode="Add",this.modalItem=this.addingItem,this.showModal()},editItem:function(t){this.writeMode="Edit",this.modalItem=t,this.showModal()},viewItem:function(t){this.writeMode="View",this.modalItem=t,this.showModal()},writeItem:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,data,d,l,c,m,f,v,h,I;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.preventDefault(),e.isLoading=!0,"Add"!==e.writeMode){r.next=18;break}return r.prev=3,r.next=6,e.$addSite(e.modalItem);case 6:n=r.sent,o=n.status,data=n.data,200===o?(e.sites.push(data),e.addingItem={property:{_id:null}},e.hideModal()):console.error("Error Add Site"),r.next=18;break;case 12:r.prev=12,r.t0=r.catch(3),d=r.t0.message,l=r.t0.response,c=l?l.data:d,e.$toAst(e,c,"danger");case 18:if("Edit"!==e.writeMode){r.next=34;break}return r.prev=19,r.next=22,e.$editSite(e.modalItem);case 22:m=r.sent,f=m.status,m.data,200===f?(e.$set(e.sites,e.sites.findIndex((function(t){return t._id===e.modalItem._id})),e.$deepClone(e.modalItem)),e.hideModal()):console.error("Error Edit Site"),r.next=34;break;case 28:r.prev=28,r.t1=r.catch(19),v=r.t1.message,h=r.t1.response,I=h?h.data:v,e.$toAst(e,I,"danger");case 34:e.isLoading=!1;case 35:case"end":return r.stop()}}),r,null,[[3,12],[19,28]])})))()}})},h=r(14),component=Object(h.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-card",{staticClass:"mx-2 full-screen",attrs:{"no-body":""}},[r("b-row",{staticClass:"mx-0 bg-default"},[r("b-col",{staticClass:"text-left"},[r("h1",{staticClass:"h2"},[r("span",{staticClass:"specialty"},[t._v("Sites")])])]),t._v(" "),r("b-col",{staticClass:"text-right"},[r("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.addNewItem}},[t._v("Add")])],1)],1),t._v(" "),r("b-table-simple",{staticClass:"h-100 mb-0 d-inline-block sticky-table",attrs:{bordered:"",hover:"",small:"",responsive:"","sticky-header":""}},[r("b-thead",[r("b-tr",[r("b-th",{staticClass:"text-nowrap"},[t._v("#")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("Name")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("Property")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("Friendly Id")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("Id")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("Thermostats")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("HVAC Plant")]),t._v(" "),r("b-th",{staticClass:"text-nowrap"},[t._v("Action")])],1)],1),t._v(" "),t._l(t.sites,(function(e,n){return r("b-tbody",{key:n},[r("b-tr",[r("b-td",{staticClass:"text-center"},[t._v(t._s(n+1))]),t._v(" "),r("b-td",[t._v(t._s(e.name))]),t._v(" "),r("b-td",[t._v(t._s(t.getPropertyName(e)))]),t._v(" "),r("b-td",[t._v(t._s(e.friendlyId))]),t._v(" "),r("b-td",[t._v(t._s(e.id))]),t._v(" "),r("b-td",{staticClass:"text-center"},[r("font-awesome-icon",{staticClass:"fai-checkbox",attrs:{icon:["fas",e.hasTStats?"check-square":"square"]}})],1),t._v(" "),r("b-td",{staticClass:"text-center"},[r("font-awesome-icon",{staticClass:"fai-checkbox",attrs:{icon:["fas",e.hasHVAC?"check-square":"square"]}})],1),t._v(" "),r("b-td",{staticClass:"text-center"},[r("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-primary"},on:{click:function(r){return t.viewItem(e)}}},[r("font-awesome-icon",{attrs:{icon:["fas","eye"]}})],1),t._v(" "),r("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-info"},on:{click:function(r){return t.editItem(e)}}},[r("font-awesome-icon",{attrs:{icon:["fas","pencil-alt"]}})],1),t._v(" "),r("b-button",{staticClass:"crud-action",attrs:{size:"sm",variant:"outline-danger"},on:{click:function(r){return t.deleteItem(e)}}},[r("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}})],1)],1)],1)],1)}))],2)],1),t._v(" "),r("b-modal",{ref:"modal-crud-sites",attrs:{id:"modal-crud-sites",size:"lg",title:t.writeMode,"hide-footer":""}},[r("b-row",[r("b-col",[r("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[r("b-form",{on:{submit:t.writeItem}},[r("b-form-group",{attrs:{id:"input-name-group",label:"Name:","label-for":"input-name"}},[r("b-form-input",{attrs:{id:"input-name",type:"text",placeholder:"Enter Name",required:"",disabled:t.disableModalItem},model:{value:t.modalItem.name,callback:function(e){t.$set(t.modalItem,"name",e)},expression:"modalItem.name"}})],1),t._v(" "),r("b-form-group",{attrs:{id:"input-property-group",label:"Property:","label-for":"input-property"}},[r("b-form-select",{attrs:{id:"input-property",type:"text",options:t.properties,"value-field":"_id","text-field":"name",placeholder:"Enter Property",required:"",disabled:t.disableModalItem},model:{value:t.modalItemPropertyId,callback:function(e){t.modalItemPropertyId=e},expression:"modalItemPropertyId"}})],1),t._v(" "),r("b-form-group",{attrs:{id:"input-friendlyId-group",label:"Friendly Id:","label-for":"input-friendlyId"}},[r("b-form-input",{attrs:{id:"input-friendlyId",type:"text",placeholder:"Enter Friendly Id",required:"",disabled:t.disableModalItem},model:{value:t.modalItem.friendlyId,callback:function(e){t.$set(t.modalItem,"friendlyId","string"==typeof e?e.trim():e)},expression:"modalItem.friendlyId"}})],1),t._v(" "),r("b-form-group",{attrs:{id:"input-id-group",label:"Id:","label-for":"input-id"}},[r("b-form-input",{attrs:{id:"input-id",type:"number",min:"0",placeholder:"Enter Id",required:"",disabled:t.disableModalItem},model:{value:t.modalItem.id,callback:function(e){t.$set(t.modalItem,"id",t._n(e))},expression:"modalItem.id"}})],1),t._v(" "),r("b-row",[r("b-col",[r("b-form-checkbox",{attrs:{id:"input-hasTStats",disabled:t.disableModalItem},model:{value:t.modalItem.hasTStats,callback:function(e){t.$set(t.modalItem,"hasTStats",e)},expression:"modalItem.hasTStats"}},[t._v("  \n                    Thermostats\n                  ")])],1),t._v(" "),r("b-col",[r("b-form-checkbox",{attrs:{id:"input-hasHVAC",disabled:t.disableModalItem},model:{value:t.modalItem.hasHVAC,callback:function(e){t.$set(t.modalItem,"hasHVAC",e)},expression:"modalItem.hasHVAC"}},[t._v("  \n                    HVAC Plant\n                  ")])],1)],1),t._v(" "),r("b-row",[r("b-col",{staticClass:"text-right"},[r("b-button",{attrs:{type:"button",size:"sm",variant:"danger"},on:{click:t.hideModal}},[t._v("Cancel")]),t._v(" "),t.disableModalItem?t._e():r("b-button",{attrs:{type:"submit",size:"sm",variant:"primary"}},[t._v("Save")])],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);